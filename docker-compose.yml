version: '3'
services:
  pyvirt-uwsgi:
    image: dariusbakunas/pyvirt-api:latest
    environment:
     - FLASK_CONFIGURATION=development
    container_name: pyvirt-api
    ports:
     - 3031:3031
    volumes:
     - /etc/pki/libvirt:/etc/pki/libvirt:ro
     - /etc/pki/CA:/etc/pki/CA:ro
     - ./instance:/app/instance:ro
  pyvirt-nginx:
    image: nginx:1.13-alpine
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - pyvirt-uwsgi
    ports:
      - 80:9999