version: '3'
services:
  uwsgi:
    image: dariusbakunas/pyvirt-api:latest
    environment:
     - FLASK_CONFIGURATION=development
    container_name: pyvirt-api-uwsgi
    volumes:
     - /etc/pki/libvirt:/etc/pki/libvirt:ro
     - /etc/pki/CA:/etc/pki/CA:ro
     - ./instance:/app/instance:ro
     - ./sock:/sock
  nginx:
    image: nginx:1.13-alpine
    container_name: pyvirt-api-nginx
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
      - ./sock:/sock
    depends_on:
      - uwsgi
    ports:
      - 9999:9999